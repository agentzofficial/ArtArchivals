<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Loading…</title>
  <link rel="stylesheet" href="../style.css"/>
  <link rel="icon" type="image/png" sizes="16x16" href="../serverImages/fovicon-16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../serverImages/fovicon-32.png">
  <link rel="shortcut icon" href="../serverImages/fovicon.ico">
</head>
<body class="non-gallery">
  <img id="fixed-bg" src="" alt="" aria-hidden="true" />
  <header class="site-nav">
    <nav>
      <ul>
        <li><a href="/index.html">Gallery</a></li>
        <li><span class="separator">|</span></li>
        <li><a href="/news.html" class="active">News</a></li>
        <li><span class="separator">|</span></li>
        <li><a href="/contact.html">Contact</a></li>
        <li><span class="separator">|</span></li>
        <li><a href="/policies.html">Usage Policies</a></li>
        <li><span class="separator">|</span></li>
        <li class="theme-selector">
          <select id="theme-select" aria-label="Choose theme">
            <option value="agentz">agent z Theme</option>
            <option value="dark">Basic Black</option>
            <option value="light">Basic White</option>
          </select>
        </li>
      </ul>
    </nav>
  </header>
  
  <article class="news-post" data-auto-current-id>
    <span id="news-tag" class="news-tag"></span>
    <h1 id="news-title" class="news-title"></h1>
    <time id="news-date" class="news-date"></time>
    <img id="news-image" class="news-image" alt="Preview image" />
    <div class="news-content">
      <p><em>agent z</em> has posted 4 sneak peaks all at once in relation to the next episode, with its release date set to be on May 3rd!</p>
      <img
        src="/imagesPreview/2025-4-25_1.webp"
        alt="preview"
        class="news-image"
      />
      <p>The first image features Neo Agent 3 and Agent 8 playing a video game off screen using Nintendo Switch Pro Controllers. While it's common to see the two here in Splatshorts, it has yet
      to actually be seen in a Splatoon Animation. Neo Agent 3 seems focused on the game, while Agent 8 looks relatively relaxed, just having fun!</p>
      <hr class="section-divider" />
      <img
        src="/imagesPreview/2025-4-25_2.webp"
        alt="preview"
        class="news-image"
      />
      <p>The second image features 3 Great Zapfish on the ground in Splatsville in visible shock. What could it mean?</p>
      <hr class="section-divider" />
      <img
        src="/imagesPreview/2025-4-25_3.webp"
        alt="preview"
        class="news-image"
      />
      <p>The third image features Agent X peaking around a door with a more devious expression, alongside orange lighting. She wouldn't be planning something bad again, right?</p>
      <hr class="section-divider" />
      <img
        src="/imagesPreview/2025-4-25_4.webp"
        alt="preview"
        class="news-image"
      />
      <p>The fourth and final image in the community post features Agent Z and Agent 3 looking surprised at something towards the camera off screen. This confirms that the entire main cast
        will appear in the episode in some way. But wait, what's that thing behind Agent Z? I don't remember that being in the apartment.</p>
      <hr class="section-divider" />
      <p>All questions will be answered when this episode is uploaded on May 3rd! Hope to see you there!</p>
    </div>
  </article>

  <div id="next-up-wrapper" data-auto-current-id>
    <h2>Next Up</h2>
    <div id="next-up-container" class="news-grid">
    </div>
  </div>
  
  <div class="browse-news-container">
    <a href="../news.html" class="browse-news-button">Browse News</a>
  </div>
  
  <footer>
    &copy; 2025 agent z Art Archivals<br>Not affiliated with Nintendo. All trademarks and copyrights belong to their respective owners.
  </footer>

  <script>
    // <h2> = heading <h3> = smaller heading <strong> = bold <em> = italics | that <img> is for images
    const THEME_KEY = 'preferredTheme';
    const select    = document.getElementById('theme-select');
    const bodyEl    = document.body;
  
    if (!document.getElementById('fixed-bg')) {
      const agentzOption = select?.querySelector('option[value="agentz"]');
      if (agentzOption) agentzOption.disabled = true;
    }
  
    function applyTheme(theme) {
      bodyEl.classList.remove('theme-dark','theme-light','theme-agentz');
      bodyEl.classList.add('theme-' + theme);
      localStorage.setItem(THEME_KEY, theme);
  
      const bgImg = document.getElementById('fixed-bg');
      if (!bgImg) return;
  
      if (theme === 'agentz') {
        bgImg.style.display = '';
        const maxBg = 9;
        const n     = Math.floor(Math.random() * maxBg) + 1;
        bgImg.src   = `../backgrounds/bg${n}.webp`;
      } else {
        bgImg.style.display = 'none';
      }
    }
  
    const savedTheme = localStorage.getItem(THEME_KEY) || 'agentz';
    applyTheme(savedTheme);
  
    if (select) {
      select.value = savedTheme;
      select.addEventListener('change', () => applyTheme(select.value));
    }
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const pageId = location.pathname.split('/').pop().replace('.html', '');
  
      document.querySelectorAll('[data-auto-current-id]').forEach(el => {
        el.setAttribute('data-current-id', pageId);
      });
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const pageId = location.pathname
        .split('/')
        .pop()
        .replace('.html', '');

      document.querySelectorAll('[data-auto-current-id]').forEach(el => {
        el.setAttribute('data-current-id', pageId);
      });
      const articleElem = document.querySelector('article.news-post');
      const currentId = articleElem?.getAttribute('data-current-id');

      if (!currentId) {
        console.error('Current ID not set on article element.');
        return;
      }

      fetch('/data/news.json')
        .then(r => r.json())
        .then(newsArray => {
          newsArray.sort((a, b) => new Date(b.date) - new Date(a.date));

          const currentObj = newsArray.find(item => item.id === currentId);
          if (!currentObj) {
            console.error('No JSON entry found for ID:', currentId);
            return;
          }

          document.getElementById('news-tag').innerText = currentObj.tag;
          document.getElementById('news-title').innerText = currentObj.title;
          const d = new Date(currentObj.date);
          const formatted = d.toLocaleDateString('en-GB', {
            day:   'numeric',
            month: 'long',
            year:  'numeric'
          });
          document.getElementById('news-date').innerText = formatted;

          const img = document.getElementById('news-image');
          img.src = `/${currentObj.thumbnail}`;
          img.alt = currentObj.title + ' thumbnail';

          document.title = currentObj.title + ' – agent z Art Archivals';

          const idx = newsArray.findIndex(item => item.id === currentId);
          const newerItem = (idx > 0) ? newsArray[idx - 1] : null;
          const olderItem = (idx < newsArray.length - 1) ? newsArray[idx + 1] : null;

          if (!newerItem && !olderItem) {
            document.getElementById('next-up-wrapper').style.display = 'none';
            return;
          }

          function makeNewsCard(item) {
            const card = document.createElement('a');
            card.href = `./${item.id}.html`;
            card.className = 'news-card';

            const dateObj = new Date(item.date);
            const dateFormatted = dateObj.toLocaleDateString('en-GB', {
              day:   'numeric',
              month: 'long',
              year:  'numeric'
            });

            card.innerHTML = `
              <img src="/${item.thumbnail}" alt="${item.title}" class="news-thumb"/>
              <span class="news-tag">${item.tag}</span>
              <h3 class="news-title">${item.title}</h3>
              <time class="news-date">${dateFormatted}</time>
            `;
            return card;
          }

          const container = document.getElementById('next-up-container');
          if (newerItem) container.appendChild(makeNewsCard(newerItem));
          if (olderItem)  container.appendChild(makeNewsCard(olderItem));
        })
        .catch(err => {
          console.error('Error loading news.json:', err);
          document.getElementById('next-up-wrapper').style.display = 'none';
        });
    });
  </script>
  <script>
    function shrinkDialogueIfNeeded() {
      if (
        window.innerWidth <= 480 &&
        window.matchMedia("(orientation: portrait)").matches
      ) {
        document.querySelectorAll(".dialogue-text").forEach(el => {
          let style = window.getComputedStyle(el);
          let fontSizePx = parseFloat(style.fontSize);
          const containerHeight = el.clientHeight;
          while (el.scrollHeight > containerHeight && fontSizePx > 8) {
            fontSizePx -= 1;
            el.style.fontSize = fontSizePx + "px";
          }
        });
      }
    }
  
    window.addEventListener("DOMContentLoaded", shrinkDialogueIfNeeded);
    window.addEventListener("resize", shrinkDialogueIfNeeded);
    window.matchMedia("(orientation: portrait)").addEventListener("change", shrinkDialogueIfNeeded);
  </script>
</body>
</html>
